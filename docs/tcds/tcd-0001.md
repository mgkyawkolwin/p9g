# Test Cases: P9G Prepaid Package Module
**Module:** Prepaid Package & Reservation Integration
**Version:** 1.0
**Author:** QA Team
**Date:** 26/08/2025

## Test Case ID: TC-PK-01
**Title:** Verify Creation of a New Prepaid Package
**Related US:** US-01
**Precondition:** User is logged in. A member exists to be selected as the purchaser.

| Step | Test Step Description | Test Data | Expected Result | Status (Pass/Fail) |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Navigate to the Prepaid Packages page. | | Page loads successfully. | |
| 2 | Click the "New Package" button. | | A new package form modal appears. | |
| 3 | Fill in all required fields with valid data. | Customer: `John Doe`, Start Date: `Today`, Days: `90`, Amount: `100.00` | Fields accept the input. | |
| 4 | Click the "Save" button. | | Form closes. A success message "Prepaid package saved successfully" is displayed. The new package appears in the list with `90` days remaining. | |

## Test Case ID: TC-PK-02
**Title:** Verify Validation Error on Package Creation
**Related US:** US-01
**Precondition:** User is logged in and on the New Package form.

| Step | Test Step Description | Test Data | Expected Result | Status (Pass/Fail) |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Leave the 'Customer' field blank. | Customer: `` (empty) | Field shows a validation error. | |
| 2 | Enter a negative number for 'Days'. | Days: `-5` | Field shows a validation error. | |
| 3 | Click the "Save" button. | | System does not save. A validation error message "Please check your inputs" is displayed on the form. | |

## Test Case ID: TC-RES-01
**Title:** Verify Applying a Valid Prepaid ID to a Reservation
**Related US:** US-04, Use Case Main Flow
**Precondition:** User is on the New Reservation page. A valid Active prepaid package exists with ID `PREPAID-123` (90 days rem).

| Step | Test Step Description | Test Data | Expected Result | Status (Pass/Fail) |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Select "Member" as reservation type. | | Type is selected. | |
| 2 | Enter the valid Prepaid ID. | Prepaid ID: `PREPAID-123` | System validates and shows a green checkmark. Package details (e.g., "90 days remaining") are displayed. | |
| 3 | Enter guest info and stay dates. | Check-in: `Today`, Check-out: `Today + 5 days` | Fields are filled. | |
| 4 | Click "Save". | | Reservation is saved. Success message "Reservation created successfully. Prepaid package PREPAID-123 applied." is shown. The reservation is linked to the package. | |

## Test Case ID: TC-RES-02
**Title:** Verify Error when Applying an Invalid Prepaid ID
**Related US:** US-04, Use Case Alternative Flow (Invalid ID)
**Precondition:** User is on the New Reservation page.

| Step | Test Step Description | Test Data | Expected Result | Status (Pass/Fail) |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Enter an invalid Prepaid ID. | Prepaid ID: `INVALID-456` | System shows a red error message: "Invalid Prepaid ID or package has no remaining days." | |
| 2 | Attempt to click "Save". | | The "Save" button is disabled, or click is prevented, and the error remains. | |

## Test Case ID: TC-DED-01
**Title:** Verify Automatic Deduction on Check-in
**Related US:** US-05
**Precondition:** A reservation is created and linked to Prepaid ID `PREPAID-123` which has 90 days remaining. The reservation is for 5 nights.

| Step | Test Step Description | Test Data | Expected Result | Status (Pass/Fail) |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Navigate to the reservation list. | | Find the target reservation. | |
| 2 | Perform the "Check-in" action for the reservation. | | System processes the check-in. | |
| 3 | Navigate to the Prepaid Packages list. | | Find package `PREPAID-123`. | |
| 4 | Verify package details. | | Package `Usage` is now `5`. Package `Remaining` is now `85`. | |

## Test Case ID: TC-DED-02
**Title:** Verify Check-in is blocked for Insufficient Days
**Related US:** US-05
**Precondition:** A reservation is created and linked to Prepaid ID `PREPAID-789` which has only 2 days remaining. The reservation is for 5 nights.

| Step | Test Step Description | Test Data | Expected Result | Status (Pass/Fail) |
| :--- | :--- | :--- | :--- | :--- |
| 1 | Attempt to perform the "Check-in" action for this reservation. | | System prevents check-in. An error message is displayed: "Prepaid package PREPAID-789 has insufficient days for this stay. 2 days remaining, 5 nights required." | |
| 2 | Verify package details. | | Package `Usage` is still `88`. Package `Remaining` is still `2`. No deduction occurred. | |